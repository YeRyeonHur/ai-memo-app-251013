# Story 1.1: 이메일/비밀번호 회원가입

## Status

Draft

---

## Story

**As a** 신규 사용자,  
**I want** 이메일과 비밀번호로 간편하게 회원가입을 하고 싶다,  
**so that** AI 메모장 서비스를 사용하여 내 노트를 작성하고 관리할 수 있다.

---

## Acceptance Criteria

1. 사용자는 이메일 주소와 비밀번호를 입력하여 회원가입할 수 있어야 한다
2. 이메일 형식이 유효한지 클라이언트에서 검증되어야 한다
3. 비밀번호는 최소 8자 이상이어야 하며, 비밀번호 확인 입력이 일치해야 한다
4. 회원가입 성공 시 Supabase Auth에 사용자가 생성되어야 한다
5. 회원가입 성공 후 자동으로 로그인되어 대시보드로 리디렉션되어야 한다
6. 이미 존재하는 이메일로 가입 시도 시 명확한 에러 메시지를 표시해야 한다
7. 회원가입 중 로딩 상태가 사용자에게 표시되어야 한다
8. 회원가입 폼은 반응형이어야 하며 모바일에서도 사용 가능해야 한다

---

## Tasks / Subtasks

- [ ] Task 1: Supabase 프로젝트 생성 및 설정 (AC: 4)
  - [ ] Supabase 대시보드에서 새 프로젝트 생성
  - [ ] 프로젝트 URL 및 API 키 확보
  - [ ] 환경 변수 파일 (.env.local) 생성
    - `NEXT_PUBLIC_SUPABASE_URL`
    - `NEXT_PUBLIC_SUPABASE_ANON_KEY`
    - `SUPABASE_SERVICE_ROLE_KEY`
  - [ ] .env.example 파일 생성 (민감 정보 제외)

- [ ] Task 2: Supabase 클라이언트 헬퍼 함수 작성 (AC: 4)
  - [ ] `lib/supabase/client.ts` 생성 (클라이언트 컴포넌트용)
  - [ ] `lib/supabase/server.ts` 생성 (서버 컴포넌트용)
  - [ ] Supabase 클라이언트 초기화 및 export
  - [ ] 타입 안전성 확보 (TypeScript)

- [ ] Task 3: 회원가입 페이지 UI 구현 (AC: 1, 2, 3, 7, 8)
  - [ ] `/app/(auth)/signup/page.tsx` 생성
  - [ ] shadcn/ui Form, Input, Button 컴포넌트 설치 및 설정
  - [ ] 회원가입 폼 레이아웃 작성
    - 이메일 입력 필드
    - 비밀번호 입력 필드 (type="password")
    - 비밀번호 확인 입력 필드
    - 회원가입 버튼
  - [ ] 폼 검증 로직 추가 (React Hook Form + Zod)
    - 이메일 형식 검증
    - 비밀번호 최소 8자 검증
    - 비밀번호 일치 검증
  - [ ] 로딩 상태 UI (버튼 비활성화 + 스피너)
  - [ ] 에러 메시지 표시 영역
  - [ ] 반응형 디자인 적용

- [ ] Task 4: 회원가입 Server Action 구현 (AC: 4, 5, 6)
  - [ ] `app/(auth)/actions.ts` 생성
  - [ ] `signUpWithEmail` Server Action 작성
    - 이메일, 비밀번호 파라미터 받기
    - Supabase Auth의 `signUp` 메서드 호출
    - 성공 시 세션 생성 확인
    - 에러 처리 (중복 이메일, 네트워크 에러 등)
  - [ ] 타입 정의 (파라미터, 반환값)

- [ ] Task 5: 회원가입 플로우 통합 및 리디렉션 (AC: 5)
  - [ ] 회원가입 폼 제출 시 Server Action 호출
  - [ ] 성공 시 `/dashboard` 또는 `/notes`로 리디렉션
  - [ ] 실패 시 에러 메시지 표시
  - [ ] Toast 알림 추가 (성공/실패)

- [ ] Task 6: 회원가입 기능 테스트 작성
  - [ ] 단위 테스트: 폼 검증 로직
  - [ ] 통합 테스트: Server Action 호출
  - [ ] E2E 테스트: 전체 회원가입 플로우 (선택적)

---

## Dev Notes

### 기술 스택
[Source: docs/architecture.md#1-기술-스택]
- **프레임워크:** Next.js (App Router, Server Actions)
- **UI:** shadcn/ui + Tailwind + Radix UI
- **DB/인증:** Supabase (Postgres, Auth, Storage)

### 인증 아키텍처
[Source: docs/architecture.md#3-보안]
- Supabase Auth를 사용하여 사용자 인증 처리
- 환경 변수로 API 키 관리 (클라이언트/서버 분리)
- 서비스 롤 키는 서버 전용으로 사용

### 프로젝트 구조 (예상)
```
app/
├── (auth)/
│   ├── signup/
│   │   └── page.tsx       # 회원가입 페이지
│   └── actions.ts         # 인증 관련 Server Actions
lib/
├── supabase/
│   ├── client.ts          # 클라이언트 사이드 Supabase 클라이언트
│   └── server.ts          # 서버 사이드 Supabase 클라이언트
```

### 환경 변수
- `NEXT_PUBLIC_SUPABASE_URL`: Supabase 프로젝트 URL (클라이언트에서 접근 가능)
- `NEXT_PUBLIC_SUPABASE_ANON_KEY`: Supabase Anon 키 (클라이언트에서 접근 가능)
- `SUPABASE_SERVICE_ROLE_KEY`: Supabase 서비스 롤 키 (서버 전용)

### 폼 검증 규칙
- 이메일: 유효한 이메일 형식 (RFC 5322)
- 비밀번호: 최소 8자 이상
- 비밀번호 확인: 비밀번호와 일치

### 에러 처리
- 중복 이메일: "이미 사용 중인 이메일 주소입니다"
- 네트워크 에러: "네트워크 연결을 확인해주세요"
- 유효하지 않은 입력: 각 필드별 에러 메시지 표시

### UI/UX 고려사항
- 로딩 상태 명확히 표시 (버튼 비활성화 + 스피너)
- 에러 메시지는 필드 하단에 빨간색으로 표시
- 성공 시 Toast 알림 후 자동 리디렉션
- 반응형 디자인: 모바일/태블릿/데스크톱 모두 지원

---

## Testing

### 테스트 표준
[Source: 프로젝트 규칙]
- 테스트 프레임워크: Jest (또는 Vitest)
- 테스트 파일 위치: `__tests__/` 디렉토리 또는 컴포넌트와 동일 위치에 `.test.tsx`
- 테스트 커버리지 목표: 80% 이상

### 테스트 항목
1. **단위 테스트**
   - 이메일 형식 검증 함수
   - 비밀번호 검증 함수
   - 비밀번호 일치 검증

2. **통합 테스트**
   - `signUpWithEmail` Server Action
   - Supabase Auth 호출
   - 에러 처리 로직

3. **E2E 테스트 (선택적)**
   - 회원가입 폼 작성 → 제출 → 리디렉션

---

## Change Log

| Date       | Version | Description          | Author         |
|------------|---------|----------------------|----------------|
| 2025-10-13 | 1.0     | Story 초기 작성      | Bob (SM)       |

---

## Dev Agent Record

### Agent Model Used

(To be filled by Dev Agent)

### Debug Log References

(To be filled by Dev Agent)

### Completion Notes List

(To be filled by Dev Agent)

### File List

(To be filled by Dev Agent)

---

## QA Results

(To be filled by QA Agent)


