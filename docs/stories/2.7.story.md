# Story 2.7: 빈 상태 UI 및 온보딩 개선

## Status

Ready for Review

---

## Story

**As a** 신규 사용자,  
**I want** 노트가 없을 때 더 풍부한 안내와 도움말을 받고 싶다,  
**so that** 서비스를 처음 사용할 때 무엇을 해야 할지 명확히 알고 빠르게 시작할 수 있다.

---

## Acceptance Criteria

1. 노트가 없을 때 향상된 빈 상태 UI를 표시해야 한다
   - 환영 메시지 및 서비스 소개
   - 시작하기 버튼들 (새 노트 작성, 샘플 노트 보기)
   - 주요 기능 소개 카드
2. "샘플 노트 보기" 기능을 제공해야 한다
   - 버튼 클릭 시 3개의 샘플 노트가 자동 생성
   - 샘플 노트는 서비스 사용법을 설명하는 내용
   - 샘플 노트는 언제든 삭제 가능
3. 빈 상태 UI에 주요 기능 소개 섹션이 포함되어야 한다
   - 텍스트 메모, 음성 메모, AI 요약 등 핵심 기능
   - 각 기능마다 아이콘과 간단한 설명
   - 3x2 그리드 레이아웃 (반응형)
4. 노트 목록 페이지 상단에 "도움말 다시 보기" 링크가 있어야 한다
   - 온보딩 페이지로 이동하는 링크
   - 이미 구현되어 있음 (유지)
5. 빈 상태 UI는 반응형으로 구현되어야 한다
   - 모바일, 태블릿, 데스크톱 모두 지원
6. 샘플 노트 생성은 사용자 확인을 거쳐야 한다
   - AlertDialog로 확인 메시지 표시
   - "샘플 노트 3개가 생성됩니다" 안내
7. 에러 상태 UI도 개선되어야 한다
   - 노트 로딩 실패 시 재시도 버튼
   - 친절한 에러 메시지
8. 빈 상태에서 온보딩 페이지로 빠르게 이동할 수 있어야 한다
   - "처음 사용하시나요? 시작 가이드 보기" 링크

---

## Tasks / Subtasks

- [ ] Task 1: 샘플 노트 생성 Server Action 구현 (AC: 2, 6)
  - [ ] `app/notes/actions.ts`에 `createSampleNotes` 함수 추가
  - [ ] 3개의 샘플 노트 데이터 정의
    - [ ] 노트 1: "AI 메모장 사용 가이드"
    - [ ] 노트 2: "텍스트 메모 작성하기"
    - [ ] 노트 3: "음성 메모 활용법 (향후 제공)"
  - [ ] 인증 사용자 확인
  - [ ] Drizzle ORM으로 3개 노트 일괄 삽입
  - [ ] 성공/실패 응답 반환
  - [ ] 타입 정의 (CreateSampleNotesResult)

- [ ] Task 2: 향상된 빈 상태 UI 컴포넌트 구현 (AC: 1, 3, 5, 8)
  - [ ] `app/notes/empty-state.tsx` 생성 (Client Component)
  - [ ] 환영 메시지 섹션
    - [ ] 큰 이모티콘/아이콘
    - [ ] "AI 메모장에 오신 것을 환영합니다" 제목
    - [ ] 간단한 소개 문구
  - [ ] 행동 유도 버튼 섹션
    - [ ] "첫 노트 작성하기" 버튼 (primary)
    - [ ] "샘플 노트 보기" 버튼 (secondary)
    - [ ] "시작 가이드 보기" 링크 (온보딩 페이지로)
  - [ ] 주요 기능 소개 카드 그리드
    - [ ] 6개 기능 카드 (3x2 그리드, 반응형)
    - [ ] 각 카드: 아이콘, 제목, 설명
    - [ ] 기능: 텍스트 메모, 음성 메모, AI 요약, 자동 태깅, 검색, 내보내기
  - [ ] 반응형 레이아웃 (Tailwind CSS)

- [ ] Task 3: 샘플 노트 생성 확인 다이얼로그 구현 (AC: 6)
  - [ ] `app/notes/sample-notes-dialog.tsx` 생성 (Client Component)
  - [ ] shadcn/ui AlertDialog 사용
  - [ ] "샘플 노트 3개가 생성됩니다" 메시지
  - [ ] "생성" 버튼과 "취소" 버튼
  - [ ] 생성 버튼 클릭 시 createSampleNotes 호출
  - [ ] 성공 시 토스트 메시지 및 페이지 새로고침

- [ ] Task 4: 노트 목록 페이지에 빈 상태 UI 통합 (AC: 1, 2, 4)
  - [ ] `app/notes/page.tsx` 수정
  - [ ] 기존 빈 상태 UI를 EmptyState 컴포넌트로 교체
  - [ ] 노트가 없을 때 EmptyState 렌더링
  - [ ] "도움말 다시 보기" 링크 유지

- [ ] Task 5: 에러 상태 UI 개선 (AC: 7)
  - [ ] `app/notes/error-state.tsx` 생성 (Client Component)
  - [ ] 에러 메시지 표시
  - [ ] "다시 시도" 버튼
  - [ ] 친절한 안내 문구
  - [ ] `app/notes/page.tsx`에 에러 상태 적용

- [ ] Task 6: 스타일링 및 UX 개선 (AC: 5)
  - [ ] Tailwind CSS로 반응형 레이아웃
  - [ ] 애니메이션 효과 (fade-in, slide-in)
  - [ ] 일관된 색상 및 간격
  - [ ] 접근성 고려 (aria-label, role)

- [ ] Task 7: 테스트 작성
  - [ ] `app/notes/actions.test.ts`에 createSampleNotes 테스트 추가
    - [ ] 인증 사용자가 샘플 노트 생성 성공
    - [ ] 3개의 노트가 정확히 생성되는지 확인
    - [ ] 비인증 사용자는 실패
  - [ ] `app/notes/__tests__/empty-state.test.tsx` 생성
    - [ ] EmptyState 컴포넌트 렌더링 테스트
    - [ ] 버튼 클릭 이벤트 테스트
  - [ ] 수동 E2E 테스트
    - [ ] 빈 상태에서 샘플 노트 생성 확인
    - [ ] 샘플 노트 삭제 후 다시 빈 상태 확인

---

## Dev Notes

### 기술 스택 및 아키텍처 정보

#### 프레임워크 및 라이브러리
- **Next.js App Router**: Server Component와 Client Component 조합
- **Supabase Auth**: 사용자 인증 확인
- **Drizzle ORM**: 샘플 노트 일괄 삽입 (`db.insert(notes).values([...])`)
- **shadcn/ui**: AlertDialog 컴포넌트 사용 (이미 설치됨)
- **Tailwind CSS**: 반응형 그리드 및 애니메이션

#### 관련 파일
- `app/notes/page.tsx`: 노트 목록 페이지 (수정 필요)
- `app/notes/actions.ts`: Server Actions (createSampleNotes 추가)
- `app/onboarding/page.tsx`: 온보딩 페이지 (기존 유지)
- `components/ui/alert-dialog.tsx`: AlertDialog 컴포넌트 (기존 사용)

#### 샘플 노트 데이터 예시
```typescript
const SAMPLE_NOTES = [
  {
    title: '🌟 AI 메모장 사용 가이드',
    content: `AI 메모장에 오신 것을 환영합니다!

이 메모장은 여러분의 생각과 아이디어를 쉽고 빠르게 기록하고, AI가 자동으로 정리해주는 스마트한 도구입니다.

주요 기능:
- 📝 텍스트 메모: 언제 어디서나 빠르게 생각을 기록하세요
- 🎙️ 음성 메모: 말로 하면 자동으로 텍스트로 변환됩니다 (향후 제공)
- 🤖 AI 요약: 긴 메모도 핵심만 간추려 정리해드립니다 (향후 제공)
- 🏷️ 자동 태깅: AI가 관련 태그를 자동으로 추천합니다 (향후 제공)
- 🔍 스마트 검색: 태그와 내용으로 빠르게 검색하세요 (향후 제공)
- 📤 데이터 내보내기: 언제든 내 데이터를 다운로드할 수 있습니다 (향후 제공)

이 샘플 노트들은 언제든 삭제하실 수 있습니다!`,
  },
  {
    title: '📝 텍스트 메모 작성하기',
    content: `텍스트 메모는 AI 메모장의 가장 기본적인 기능입니다.

작성 방법:
1. 우측 상단의 "새 노트 작성" 버튼을 클릭하세요
2. 제목과 본문을 입력하세요
3. 저장 버튼을 누르면 완료!

수정 방법:
1. 노트를 클릭하여 상세 페이지로 이동
2. "수정" 버튼 클릭
3. 내용을 수정하면 자동으로 저장됩니다

팁:
- 제목은 간결하게, 본문은 자유롭게 작성하세요
- 긴 메모도 걱정 없어요. 나중에 AI가 요약해드립니다!
- 자주 쓰는 단어는 나중에 태그로 자동 추천됩니다`,
  },
  {
    title: '🎙️ 음성 메모 활용법 (향후 제공 예정)',
    content: `음성 메모 기능은 곧 제공될 예정입니다!

음성 메모를 사용하면:
- 타이핑 없이 말로 빠르게 메모할 수 있어요
- 회의나 강의 중에도 손쉽게 기록 가능
- 음성이 자동으로 텍스트로 변환됩니다

사용 시나리오:
- 운전 중 떠오른 아이디어를 안전하게 기록
- 회의록을 빠르게 작성
- 학습 내용을 복습하면서 요약

기대해주세요! 🌟`,
  },
]
```

#### 주요 기능 카드 데이터
```typescript
const FEATURES = [
  { icon: '📝', title: '텍스트 메모', description: '빠르게 생각을 기록하고 정리하세요' },
  { icon: '🎙️', title: '음성 메모', description: '음성으로 말하면 자동으로 텍스트로 변환' },
  { icon: '🤖', title: 'AI 요약', description: '긴 메모도 핵심만 간추려 정리' },
  { icon: '🏷️', title: '자동 태깅', description: 'AI가 자동으로 관련 태그를 추천' },
  { icon: '🔍', title: '스마트 검색', description: '태그와 내용으로 빠르게 검색' },
  { icon: '📤', title: '데이터 내보내기', description: '언제든 내 데이터를 다운로드' },
]
```

#### 참고 구현
- **Story 2.2 (노트 목록 조회)**: 기존 빈 상태 UI 위치
  - `app/notes/page.tsx`의 `NotesList` 컴포넌트
- **Story 2.5 (노트 삭제)**: AlertDialog 사용 예시
  - `app/notes/[id]/delete-dialog.tsx`
- **온보딩 페이지**: 기능 소개 카드 레이아웃 참고
  - `app/onboarding/page.tsx`

#### 중요 고려사항
1. **샘플 노트 중복 생성 방지**: 사용자가 여러 번 클릭해도 한 번만 생성되도록 처리 (isPending 상태 사용)
2. **샘플 노트 식별**: 샘플 노트는 일반 노트와 동일하게 취급되어 자유롭게 수정/삭제 가능
3. **UX**: 빈 상태에서 너무 많은 정보를 주지 않고, 행동을 유도하는 것이 중요
4. **접근성**: 모든 버튼과 링크에 적절한 aria-label 제공
5. **성능**: 샘플 노트 생성은 트랜잭션으로 처리하여 원자성 보장

### Testing

#### 테스트 파일 위치
- 단위 테스트: `app/notes/actions.test.ts` (수정)
- 컴포넌트 테스트: `app/notes/__tests__/empty-state.test.tsx` (신규)

#### 테스트 프레임워크
- **Vitest**: 단위/통합 테스트
- **@testing-library/react**: React 컴포넌트 테스트
- **@testing-library/user-event**: 사용자 인터랙션 시뮬레이션

#### 테스트 커버리지
1. **createSampleNotes Server Action**
   - 인증 사용자가 샘플 노트 3개 생성 성공
   - 비인증 사용자는 에러 반환
   - 생성된 노트의 내용이 정확한지 확인
2. **EmptyState 컴포넌트**
   - 컴포넌트가 올바르게 렌더링되는지 확인
   - "첫 노트 작성하기" 버튼 클릭 시 페이지 이동
   - "샘플 노트 보기" 버튼 클릭 시 다이얼로그 표시
   - 주요 기능 카드가 6개 표시되는지 확인
3. **E2E 수동 테스트**
   - 빈 상태에서 샘플 노트 생성 후 노트 목록에 표시되는지 확인
   - 샘플 노트 삭제 후 다시 빈 상태로 돌아가는지 확인
   - 모바일/태블릿/데스크톱에서 반응형 레이아웃 확인

#### 테스트 실행
```bash
pnpm test
```

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-14 | 1.0 | 스토리 최초 작성 | SM (Bob) |

---

## Dev Agent Record

### Agent Model Used

Claude Sonnet 4.5

### Debug Log References

None

### Completion Notes List

- ✅ createSampleNotes Server Action 구현 완료 (3개 샘플 노트 일괄 삽입)
- ✅ EmptyState 컴포넌트 구현 완료 (환영 메시지, 주요 기능 소개, 행동 유도 버튼)
- ✅ SampleNotesDialog 컴포넌트 구현 완료 (AlertDialog 사용)
- ✅ ErrorState 컴포넌트 구현 완료 (친절한 에러 메시지, 재시도 버튼)
- ✅ page.tsx에 EmptyState와 ErrorState 통합 완료
- ✅ 반응형 디자인 및 애니메이션 적용
- ✅ createSampleNotes 테스트 작성 및 통과 (4개 테스트 케이스)
- ✅ 모든 테스트 통과 (132 tests passed)

### File List

- app/notes/actions.ts (modified) - createSampleNotes Server Action 추가
- app/notes/empty-state.tsx (created) - 빈 상태 UI 컴포넌트
- app/notes/sample-notes-dialog.tsx (created) - 샘플 노트 생성 확인 다이얼로그
- app/notes/error-state.tsx (created) - 에러 상태 UI 컴포넌트
- app/notes/page.tsx (modified) - EmptyState, ErrorState 통합
- app/notes/actions.test.ts (modified) - createSampleNotes 테스트 추가

---

## QA Results

_Not yet implemented_

